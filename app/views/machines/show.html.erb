<!--
Admins with permissions lvl-2 or lower are allower to access this page, customer-no
-->

<!--
Machine Information
list all the machine information contacts and location
-->
<div class="p-3">
<!-- Buffer Block -->
</div>
<h3 class="card-header shadow-sm">Machine Information</h3>

<div class="p-3">
<!-- Buffer Block -->
</div>
<!-- Customer Number name phone -->
<div class="card w-50 shadow">
  <div class="card-body d-flex flex-row justify-content-between ">
    <div>
      <div>
        <h6 class="pt-3 pr-3"><%= @machine.location.customer.bus_name %></h6>
        <h6 class="pt-3 pr-3">Location:&#160;<%= @machine.location.name%></h6>
        <h6 class="pt-3 pr-3">Tel:&#160;&#160;&#160;&#160;&#160;&#160;<%= @machine.location.phone%></h6>
      </div>
    </div>
    <div>
      <h6 class="pt-3 pr-3"><%= @machine.customer_number %></h6>
      <%= link_to "Show", customer_path(@machine.location.customer), class: "btn btn-outline-secondary mt-5" %>
    </div>
  </div>
</div>
<!--Machine Info -->
<div class="d-flex flex-row shadow"> <!-- cards wrapper -->
  <div class="card w-50">
    <div class="card-header d-flex flex-row justify-content-between">
      <h5 class="mt-2">Number: <%= @machine.machine_number %></h5>
      <div>
        <%= link_to "Delete", machine_path(@machine), class: 'btn btn-outline-danger', data: {confirm: "Are you sure?"}, method: :delete%>
      </div>
    </div>
    <!-- Machine Info -->
    <div class="card-body">
      <div class="d-flex flex-row justify-content-between">
        <!-- Phone and Email -->
        <div>
          <h5 class="card-title">Machine</h5>
          <p class="card-text m-0">Model:&#160;&#160;&#160;&#160;<%= @machine.model %></p>
          <p class="card-text m-0">Seriall#:&#160;<%= @machine.serial_number %></p>
          <p class="card-text m-0">location:&#160;<%= @machine.on_location %></p>
        </div>
        <!-- Address -->
        <div class="mr-3">
          <h5 class="card-title">Address:</h5>
          <p class="card-text d-flex justify-content-end m-0"><%= @machine.location.suite %></p>
          <p class="card-text d-flex justify-content-end m-0"><%= @machine.location.street %></p>
          <p class="card-text d-flex justify-content-end m-0"><%= @machine.location.city%>, <%= @machine.location.state%> <%= @machine.location.zip_code %></p>
          <p class="card-text d-flex justify-content-end m-0"><%= @machine.location.country %></p>
        </div>
      </div>
        <%= link_to "Add a location", new_customer_location_path(@machine.location.customer), class: "btn btn-outline-primary mt-5" %>
        <%= link_to "Add machine", new_customer_location_machine_path(@machine.location.customer, @machine.location), class: "ml-5  btn btn-outline-info mt-5" %>
    </div><!-- card-body -->
    <%= link_to "Edit", edit_machine_path(@machine), class: 'btn btn-info' %>
  </div><!-- card -->
  <!-- Contact Infomation -->
  <% if @machine.location.contact_email != nil %>
    <!-- Contact does exist -->
    <!-- Contact Infomation -->
    <div class="card w-50">
      <div class="card-header d-flex justify-content-between">
        <h5>Contact</h5>
      </div>

      <div class="card-body">
        <!-- Name -->
          <div class="d-flex flex-row justify-content-between">
            <div>
              <p class="card-text"><strong>Title:&#160;</strong><%= @machine.location.contact_title %></p>
              <p class="card-text"><strong>First name:&#160;</strong><%= @machine.location.contact__first_name %></p>
              <p class="card-text"><strong>Last name:&#160;</strong><%= @machine.location.contact__last_name %></P>
            </div>
            <!-- Phone and email -->
            <div class="mr-3">
              <p class="card-text"></p>
              <p class="card-text"><strong>Tel:&#160;</strong><%= @machine.location.contact_phone %></p>
              <p class="card-text"><strong>Email:&#160;</strong> <%= @machine.location.contact_email %></p>
          </div>
        </div>
      </div><!-- card-body -->
      <!-- Edit, Admin permission lvl-1 or lower, access-->
      <%= link_to "Edit", location_contact_path(@machine.location), class: 'btn btn-info'%>
    </div><!-- card -->
  <% else %>
    <!-- Contact does not exist -->
    <div class="card w-50">
      <!--  contact partial -->
      <%= render  'noContact' %>
      <!-- Add, Admin permission lvl-1 or lower, access-->
      <%= link_to "Add", location_contact_path(@machine.location), class: "btn btn-info mt-0" %>
    </div><!-- card -->
  <% end %>
</div><!-- cards wrapper -->
<div class="p-3">
<!-- Buffer Block -->
</div>
<h4 class="card-header shasw-sm">Service Call</h4>
<table class="table">
  <thead class="thead-light">
    <tr>
      <th scope="col">Costumer#</th>
      <th scope="col">First Name</th>
      <th scope="col">Last Name</th>
      <th scope="col">Email</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @service_calls.each do |service| %>
    <tr>
      <td><%= service.customer_number %></td>
      <td><%= service.account.first_name%></td>
      <td><%= service.account.last_name%></td>
      <td><%= service.account.last_name%></td>
      <td><%= link_to "Show", service_call_path(service),
        class: "btn-sm btn-info  mt-2  p-1"%></td>
    </tr>
    <% end %>
  </tbody>
</table>
